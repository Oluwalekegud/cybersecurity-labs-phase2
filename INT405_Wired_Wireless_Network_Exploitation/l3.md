# Lab 1: Lab - On-Path Attacks with Ettercap


#### **Objectives**
1. **Launch Ettercap and Explore Its Capabilities**
2. **Perform an On-Path (MITM) Attack**
3. **Use Wireshark to Observe the ARP Spoofing Attack**

#### **Background / Scenario**
On-path attacks (also known as MITM) allow attackers to intercept, modify, and capture data transmitted over a network without directly compromising the endpoints. This lab will guide you through performing an on-path attack using **Ettercap** and capturing ARP spoofing traffic using **Wireshark**.

#### **Required Resources**
- Kali Linux VM (with pre-configured tools)
- SSH access to the victim host (Linux device)

---

### **Part 1: Launch Ettercap and Explore its Capabilities**

#### **Step 1: Set Up an ARP Spoofing Attack**
1. Launch Kali Linux and open a terminal.
2. SSH into the victim machine at `10.6.6.23`:
   ```bash
   ssh -l labuser 10.6.6.23
   ```
   - Username: `labuser`
   - Password: `Cisco123`
3. Verify the ARP cache on the target machine:
   ```bash
   ip neighbor
   ```

#### **Step 2: Load Ettercap GUI Interface**
1. Open a new terminal session in Kali.
2. Launch the **Ettercap** GUI using the following command:
   ```bash
   sudo ettercap -G
   ```
3. In the Ettercap GUI, change the sniffing interface to **br-internal**.

---

### **Part 2: Perform the On-Path (MITM) Attack**

#### **Step 1: Select Target Devices**
1. In Ettercap, go to **Hosts > Scan for Hosts** to scan the network.
2. Add the target (`10.6.6.23`) as **Target 1** and the server (`10.6.6.13`) as **Target 2**.
3. Initiate the ARP poisoning attack:
   - Click on the **MITM** icon and select **ARP Poisoning**.
   - Ensure **Sniff remote connections** is selected.

#### **Step 2: Perform the ARP Spoofing Attack**
1. In the SSH session to the victim machine (`10.6.6.23`), initiate a ping to the server:
   ```bash
   ping -c 5 10.6.6.13
   ```
2. Check the ARP table again on the victim machine:
   ```bash
   ip neighbor
   ```

---

### **Part 3: Use Wireshark to Observe the ARP Spoofing Attack**

#### **Step 1: Select Target Devices and Perform the MITM Attack Using CLI**
1. SSH into the target (`10.6.6.23`) and verify communication with another host (`10.6.6.11`):
   ```bash
   ping -c 5 10.6.6.11
   ping -c 5 10.6.6.13
   ip neighbor
   ```
2. Start **Ettercap** using CLI to capture the attack:
   ```bash
   sudo ettercap -T -q -i br-internal --write mitm-saved.pcap --mitm arp /10.6.6.23// /10.6.6.13//
   ```
3. Observe the traffic and save it for analysis in **Wireshark**.

---

### **Lab Report Sections**

1. **How many entries are there in the current ARP cache?**
   - [Answer here]

2. **What is the MAC address of the Kali attacker machine?**
   - [Answer here]

3. **How many user interfaces are available for the Ettercap tool?**
   - [Answer here]

4. **How many hosts were discovered?**
   - [Answer here]

5. **Is the MAC address associated with 10.6.6.13 the same as in Part 1?**
   - [Answer here]

6. **What is strange about this change, and what is its effect?**
   - [Answer here]

7. **IP-MAC Address Table**
   | IP Address  | MAC Address  | Role                 |
   | ----------- | ------------ | -------------------- |
   | 10.6.6.1    | [Answer]     | Attacker             |
   | 10.6.6.11   | [Answer]     | Bystander            |
   | 10.6.6.13   | [Answer]     | Target 2 (server)    |
   | 10.6.6.23   | [Answer]     | Target 1 (user)      |

8. **Ettercap Options Table**
   | Options and Values | Meaning               |
   | ------------------ | --------------------- |
   | -T                 | [Answer]              |
   | -q                 | [Answer]              |
   | -i                 | [Answer]              |
   | --write            | [Answer]              |
   | --mitm arp         | [Answer]              |
   | /target1//         | [Answer]              |
   | /target2//         | [Answer]              |

---

### **Submission**
- Submit a detailed report documenting the ARP spoofing attack, the network configurations, and screenshots of your Wireshark capture file.