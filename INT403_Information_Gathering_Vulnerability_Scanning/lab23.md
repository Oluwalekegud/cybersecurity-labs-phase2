# Lab - Finding Information from SSL Certificates

## Objectives
- View certificate information on hosts.
- Access detailed certificate information.
- Use SSL analysis tools in Kali.
- Gather certificate information using Kali tools.

## Background / Scenario
SSL/TLS certificates validate website ownership and encrypt communication between clients and servers. They are essential for secure browsing but often go unnoticed by users. Ethical hackers can leverage certificate information during the reconnaissance phase of penetration tests, revealing organizational details such as domain names, issuance and expiration dates, and public keys. Additionally, vulnerabilities in software like OpenSSL can be exploited.

## Required Resources
- Kali VM customized for Ethical Hacker course.
- Internet access.

## Instructions

### Part 1: View Certificate Information on Hosts

#### Step 1: View Site Certificates from a Browser
1. Navigate to [skillsforall.com](https://skillsforall.com).
2. Click the padlock icon next to the URL to explore the certificate settings.
3. Examine the certificate details for the Skills for All certificate.

- **What domain was the certificate issued to? What organization issued it?**
  
  **Answer:**
  <!----><!---->

- **When will the certificate expire?**
  
  **Answer:**
  <!----><!---->

- **What is the certificate signature encryption algorithm?**
  
  **Answer:**
  <!----><!---->

#### Step 2: View Stored Certificates in the Operating System
1. For Windows: Open the certificate manager by entering `certmgr.msc` in the search box.
2. For Kali: Navigate to `/usr/share/ca-certificates/mozilla`, right-click a certificate, and select "Open With 'ViewFile'."

- **Identify three common certificate authorities on your computer and research them. What is the cost of a single-domain basic SSL certificate for one year?**
  
  **Answer:**
  <!----><!---->

### Part 2: Access Detailed Certificate Information Online
1. Navigate to [crt.sh](https://crt.sh).
2. Enter the Skills for All URL and click Search.

- **Note the names of the subdomains. Who do you think these subdomains are intended to be used by? Explain.**
  
  **Answer:**
  <!----><!---->

- **What other domain is associated with the Skills for All domain according to the crt.sh information?**
  
  **Answer:**
  <!----><!---->

- **What general observation can you make about the domains revealed from this search? What does this imply about the network?**
  
  **Answer:**
  <!----><!---->

### Part 3: Use SSL Analysis Tools in Kali

#### Step 1: Investigate Kali Tools
1. Start your Kali VM and open a terminal.
2. Search for SSL tools in Kali.

| Tool        | Description                                                  | Recon, Exploitation, or Utility |
|-------------|-------------------------------------------------------------|----------------------------------|
| sslscan     | Queries SSL services to determine supported ciphers         | Reconnaissance                   |
| Answer Area |                                                             |                                  |
| Answer Area |                                                             |                                  |
| Answer Area |                                                             |                                  |
| Answer Area |                                                             |                                  |
| Answer Area |                                                             |                                  |

### Part 4: Use Kali Tools to Gather Certificate Information

#### Step 1: Install `aha`
1. Update your package information:
   ```bash
   sudo apt update
   ```
2. Install `aha`:
   ```bash
   sudo apt install -y aha
   ```

#### Step 2: Run `sslscan` and Save the Output to an HTML File
1. Run `sslscan`:
   ```bash
   sslscan skillsforall.com
   ```
2. Pipe the output to `aha` and redirect to an HTML file:
   ```bash
   sslscan skillsforall.com | aha > sfa_cert.html
   ```
3. Open the HTML file with Firefox to view the results.

### Reflection Question
- **Compare the output of the tools used in this lab. Which tool seems to give the most useful information?**
  
  **Answer:**
  <!----><!---->

### Additional Exercises

#### Exercise 1: Certificate Expiration and Renewal
- **Task:** Research what happens when an SSL certificate expires. What steps should be taken to renew a certificate before it expires?
  
  **Answer:**
  <!----><!---->

#### Exercise 2: SSL Vulnerabilities
- **Task:** Investigate recent vulnerabilities related to SSL/TLS (e.g., Heartbleed, POODLE). Summarize a couple of notable vulnerabilities and their impacts.
  
  **Answer:**
  <!----><!---->

#### Exercise 3: Ethical Implications
- **Task:** Discuss the ethical implications of using SSL analysis tools. When is it appropriate to conduct such scans, and when is it considered intrusive?
  
  **Answer:**
  <!----><!---->

#### Exercise 4: Monitor CT Logs
- **Task:** Set up an account with a CT monitoring tool (like CertSpotter) to receive alerts about new certificates issued for a domain of your choice.
  
  **Answer:**
  <!----><!---->

### Conclusion
Reflect on how understanding SSL certificates enhances your cybersecurity knowledge and the importance of maintaining secure communications on the internet.

**Answer:**
<!----><!---->
