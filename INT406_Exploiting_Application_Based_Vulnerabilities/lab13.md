# Lab 13: Cross Site Scripting (XSS) Exploits

### Objectives
In this lab, you will:
- Perform **Reflected XSS** and **Stored XSS** attacks on the DVWA (Damn Vulnerable Web Application) at Low, Medium, and High security levels.

### Part 1: Reflected Cross Site Scripting (XSS) Exploits

A **Reflected XSS attack** occurs when a malicious script is reflected off a web server onto the user’s browser. The script is triggered when the user clicks a malicious link, sending a request to a vulnerable website, which reflects back the malicious script.

#### Step 1: Log into DVWA
1. Open your Kali Linux VM and navigate to the DVWA web application using the URL `http://10.6.6.13`.
2. Log in using the credentials: `admin/password`.

#### Step 2: Perform a Reflected XSS Attack at Low Security Level
1. In the left menu, select **DVWA Security**, set the Security Level to **Low**, and click **Submit**.
2. Select **XSS (Reflected)** from the left menu.
3. Enter `Reflected_Test` in the "What’s your name?" box and click **Submit**.
4. Use **CTRL+U** to view the page’s source code, and search for `Hello Reflected_Test`.
5. Next, enter the following payload in the "What’s your name?" box and click **Submit**:
   ```html
   <script>alert("You are hacked!")</script>
   ```
6. An alert popup with the message "You are hacked!" will appear, indicating the site is vulnerable to a reflected XSS attack.

#### Step 3: Perform a Reflected XSS Attack at Medium Security Level
1. Set the DVWA Security Level to **Medium** and repeat the same steps as above, entering the following script:
   ```html
   <script>alert("You are hacked!")</script>
   ```
2. This time, the script will not execute because the page source code includes a filtering function (`str_replace()`), removing the `<script>` tag.
3. Bypass this by changing the script case:
   ```html
   <ScRipt>alert("You are hacked!")</ScRipt>
   ```
4. This should trigger the popup, as the filtering mechanism only checks for lowercase `<script>`.

#### Step 4: Perform a Reflected XSS Attack at High Security Level
1. Set the DVWA Security Level to **High** and repeat the steps, entering the following payload:
   ```html
   <ScRipt>alert("You_are_hacked!")</ScRipt>
   ```
2. The script will not execute. On reviewing the PHP source code, you’ll see a regular expression filtering out various forms of `<script>`.
3. To bypass, use the following alternative payload:
   ```html
   <img src=x onerror=alert("You_are_hacked!")>
   ```
4. The popup will appear, successfully exploiting the XSS vulnerability at High security.

### Part 2: Stored Cross Site Scripting (XSS) Exploits

In **Stored XSS** attacks, the malicious script is saved on the server (e.g., in a comment field or guestbook) and executed when users visit the page.

#### Step 1: Perform a Stored XSS Attack at Low Security Level
1. Set the DVWA Security Level to **Low**.
2. Select **XSS (Stored)** from the menu.
3. Enter `XSS Test#1` in the Name field and `Stored XSS Test` in the Message field, then click **Sign Guestbook**.
4. Enter the following payload in the Message field and click **Sign Guestbook**:
   ```html
   <script>alert("You are hacked!")</script>
   ```
5. A popup will appear, indicating the site is vulnerable to stored XSS.
6. Refresh the page, and the popup will reappear as the script is stored in the guestbook.

#### Step 2: Perform a Stored XSS Attack at Medium Security Level
1. Set the DVWA Security Level to **Medium**.
2. Repeat the same steps, but this time the script `<script>alert("You are hacked!")</script>` won’t work.
3. Use `<ScRipt>alert("You are hacked!")</ScRipt>` instead to bypass the filter.
4. An alert popup will appear, confirming the vulnerability.

#### Step 3: Perform a Stored XSS Attack at High Security Level
1. Set the DVWA Security Level to **High**.
2. The system uses advanced filters and whitelists. However, by bypassing the restrictions with the following payload, you can still exploit it:
   ```html
   <img src=x onerror=alert("You_are_hacked!")>
   ```
3. This will successfully trigger the popup, confirming the stored XSS vulnerability at High security.

### Conclusion
By performing these XSS attacks on DVWA at different security levels, you have demonstrated how vulnerabilities can be exploited and how increasing security layers can mitigate these risks.