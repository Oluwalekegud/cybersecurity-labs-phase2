

# Lab 4 - Using the GVM Vulnerability Scanner

**Objectives**  
In this lab, you will complete the following objectives:

- **Part 1:** Scan the OWASP Broken Web Application for Vulnerabilities  
- **Part 2:** Exploit a Vulnerability Found by GVM  

**Background / Scenario**  
GVM (Greenbone Vulnerability Management) is a comprehensive suite of tools for vulnerability management developed by Greenbone Networks GmbH. GVM's vulnerability scanner is one of the most widely utilized open-source scanners, offering a user-friendly graphical interface to initiate scans and generate detailed reports on vulnerabilities. In this lab, you will scan the OWASP Broken Web Application, which is intentionally designed to contain various security vulnerabilities, and explore potential attacks based on the vulnerabilities discovered.

**Required Resources**  
- Kali VM customized for the Ethical Hacker course  
- Internet access  
- OWASP Broken Web Application IP address (e.g  **192.168.56.101**)  

---

### Instructions

#### Part 1: Scan the OWASP Broken Web Application for Vulnerabilities

**Step 1: Start GVM Services**  
Start the GVM scanner using the command:

```bash
sudo gvm-start
```

If the browser does not open automatically, start it manually and navigate to `https://127.0.0.1:9392`. The Greenbone Security Assistant login screen will appear.  
- **Username:** admin  
- **Password:** kali  

**Step 2: Scan the OWASP Broken Web Application**  
You will now scan the OWASP Broken Web Application. This process may take approximately 20 to 30 minutes.

1. In the Greenbone Security Assistant GUI, select **Scans -> Tasks** from the menu bar.
2. Click the **Task Wizard** icon (a magic wand) and choose **Advanced Task Wizard** from the dropdown menu.
3. Name the scan **OWASP Broken Web Application** and enter the IP address **192.168.56.101** in the **Target Host(s)** field.
4. Click **Create** to initiate the scan.

Once the scan is complete, click on the number **1** under the **Reports** column next to the **OWASP Broken Web Application** task. Open the report by clicking the date and time link under the **Date** column. Navigate to the **Results** tab to view vulnerabilities found.

**Step 3: Interpret the Scan Results**  
Examine the vulnerabilities found during the scan:

- Investigate critical vulnerabilities, particularly those related to common web application vulnerabilities such as SQL Injection, Cross-Site Scripting (XSS), and Command Execution.
- Take note of the number of High severity vulnerabilities found and document some of the vulnerabilities with the highest severity scores.

**Step 4: Analyze Specific Vulnerabilities**  
Select a significant vulnerability from the Results tab (for example, SQL Injection or XSS):

- Understand the implications of the vulnerability and explore its suggested mitigations.
- Investigate the CVE associated with this vulnerability, including its CVSS Access Complexity rating.

**Step 5: Explore Open Ports**  
Check the **Ports** tab to view any open ports on the OWASP Broken Web Application. Document any findings regarding the services running on these ports.

---

#### Part 2: Exploit a Vulnerability Found by GVM

**Step 1: Perform Reconnaissance Against the Target**  
Use Nmap to identify valid endpoints and services on the OWASP Broken Web Application. Execute the following command:

```bash
sudo nmap -sV 192.168.56.101
```

Analyze the results for services running on the target.

**Step 2: Exploit a Vulnerability**  
Choose one of the identified vulnerabilities to exploit. For instance, if you found an SQL Injection vulnerability:

1. Use a tool like **SQLMap** to test for SQL Injection:
   ```bash
   sqlmap -u "http://192.168.56.101/vulnerable.php?id=1" --dbs
   ```

2. Follow the prompts to identify databases and tables, and then extract data as needed.

3. If you exploit a different vulnerability (e.g., XSS), demonstrate how to trigger it and access sensitive information.

---

### Reflection Questions

1. What steps can you take to mitigate the vulnerabilities found in the OWASP Broken Web Application after exploiting them?
   
2. How would you prioritize the vulnerabilities based on their severity and potential impact on a production environment?

---

### Submission Instructions

At the end of this lab, compile your findings, including answers to the reflection questions and any notable vulnerabilities discovered during your scanning and exploitation. Submit your report via the designated submission platform  to your instructor by the due date.

---

